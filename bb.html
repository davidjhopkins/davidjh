<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <title>Dukes Bloodbowl league</title>
  <body>
    <header>
        <div class="navbar navbar-dark bg-dark shadow-sm">
            <div class="container">
                <a href="#" class="navbar-brand d-flex align-items-center">
                    <span class="material-symbols-outlined me-4">sports_football</span>
                    <!-- <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true" class="me-2" viewBox="0 0 24 24"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg> -->
                    <strong>Dukes Bloodbowl League</strong>
                </a>
            </div>
        </div>
    </header>
    <div id="app"> 
        <main>
                <div class=" bg-light">
                  <section class="py-3 text-center container py-5 ">
                    <div class="row py-lg-5">
                      <div class="table-responsive">
                        <table class="table table-striped">
                          <thead>
                            <tr>
                              <th scope="col">#</th>
                              <th scope="col">Team</th>
                              <th scope="col">MP</th>
                              <th scope="col">W</th>
                              <th scope="col">D</th>
                              <th scope="col">L</th>
                              <th scope="col">Pts</th>
                              <th scope="col">TD</th>
                              <th scope="col">CAS</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr v-for="(item, index) in teamResults" :key="item.name">
                              <td>{{index + 1}}</td>
                              <td>{{item.name}} ({{item.coach}})</td>
                              <td>{{item.mp}}</td>
                              <td>{{item.w}}</td>
                              <td>{{item.d}}</td>
                              <td>{{item.l}}</td>
                              <td>{{item.pts}}</td>
                              <td>{{item.td}}</td>
                              <td>{{item.cas}}</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </section>
                </div>
              
                 <div class=" bg-dark">
                  <section class="py-3 text-center container py-5 ">
                  <div class="row row-cols-1 row-cols-md-3 g-4">
                    <div class="col" v-for="match in matches" :key="match.id">
                      <div class="card">
                        <div class="card-header">{{ match.date }}</div>
                        <div class="card-body">
                          <h5 class="card-title">{{teamName(match.home)}} {{ match.homeScore }} - {{ match.awayScore }} {{ teamName(match.away) }}</h5>
                          <p class="card-text">Cas: {{ match.homeCas }}  - {{ match.awayCas }}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  </section>
                </div>
        </main>
    </div>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        const { createApp } = Vue
      
        createApp({
          data() {
            return {
                teams: [
                    { id: 1, name: 'Dave rats', race: 'Skaven', coach: 'Dave H'},
                    { id: 2, name: 'Saints', race: 'Humans', coach: 'Brian'},
                    { id: 3, name: 'Bad Bay Thunder Guts', race: 'Ogre', coach: 'Brian'},
                ],
                matches: [
                     //{ id:1, date: "5th December", home: 1, away: 1, homeScore: 3, awayScore: 2, homeCas: 6, awayCas: 2 },
                ]
            }
          },
          methods: {
            teamName: function(id) {
                var team = this.teams.find(team => team.id === id);
                return team.name
            },
            sortTeams: function(teams) {
                return teams.sort(function(a, b) {
                    return b.pts - a.pts || b.td - a.td || b.cas - a.cas;
                });
            }
        },
        computed: {
            teamResults() {
            var self = this;
            var teamResults = [];
            this.teams.forEach(function(team) {
                var teamWins = 0;
                var teamDraw = 0;
                var teamLoss = 0;
                var teamTd = 0;
                var teamCas = 0;
                self.matches.forEach(function(match) {
                if(match.home === team.id) {
                    if(match.homeScore > match.awayScore) {
                    teamWins++;
                    } else if(match.homeScore === match.awayScore) {
                    teamDraw++;
                    } else {
                    teamLoss++;
                    }
                    teamTd += match.homeScore;
                    teamCas += match.homeCas;
                } else if (match.away === team.id) {
                    if(match.awayScore > match.homeScore) {
                    teamWins++;
                    } else if(match.awayScore === match.homeScore) {
                    teamDraw++;
                    } else {
                    teamLoss++;
                    }
                    teamTd += match.awayScore;
                    teamCas += match.awayCas;
                }
                })
                var teamRecord = {
                name: team.name,
                coach: team.coach,
                mp: teamWins + teamDraw + teamLoss,
                w: teamWins,
                d: teamDraw,
                l: teamLoss,
                pts: (teamWins * 3) + teamDraw,
                td: teamTd,
                cas: teamCas
                }
                teamResults.push(teamRecord);
            })
            var sortedTeams = this.sortTeams(teamResults);
            return sortedTeams
            },
            }
        }).mount('#app')
      </script>
</html>
